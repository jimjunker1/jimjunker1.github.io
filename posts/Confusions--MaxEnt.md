---
title: "Confusion:MaxEnt"
date: "30 November, 2025"
layout: collection
# knit: (function(inputFile, encoding){
#        rmarkdown::render(inputFile,
#        encoding=encoding)})
categories:
  - Miscellaneous
tags:
  - content
output:
  md_document:
    preserve_yaml: TRUE
    variant: markdown_strict 
---

Setting up the problem.

-Ecological inference problem

# Set up the maximum entropy problem

# The constraints are the total metabolic rate and the species proportions

# We seek the most likely distribution of individual metabolic rates given these constraints

    ## Inferred Metabolic Rates for Species 1 and 2:

    ## [1] 39.28951 59.08550

    ## Sum of inferred metabolic rates (should equal total metabolic rate):

    ## [1] 98.37501

#### example 2 â€”

    ## Inferred Per-Capita Metabolic Rates for Species 1 to 5:

    ## [1] 0.5430840 0.4989947 0.5706944 0.2754322 0.3142633

    ## Inference for Stan model: anon_model.
    ## 4 chains, each with iter=2000; warmup=1000; thin=1; 
    ## post-warmup draws per chain=1000, total post-warmup draws=4000.
    ## 
    ##             mean se_mean   sd    2.5%     25%     50%     75%   97.5% n_eff
    ## alpha[1]    2.45    0.01 1.03    0.45    1.74    2.46    3.15    4.48  6092
    ## alpha[2]    4.88    0.01 1.01    2.85    4.22    4.88    5.53    6.89  5828
    ## alpha[3]    7.29    0.02 1.00    5.30    6.64    7.27    7.97    9.26  4331
    ## a[1,1]      0.17    0.01 0.97   -1.72   -0.48    0.15    0.83    2.05  5948
    ## a[1,2]      0.28    0.01 0.90   -1.52   -0.33    0.28    0.87    2.06  4529
    ## a[1,3]      0.10    0.01 0.94   -1.76   -0.53    0.11    0.73    1.91  5210
    ## a[2,1]      0.27    0.01 0.91   -1.51   -0.35    0.28    0.89    2.00  4285
    ## a[2,2]      0.45    0.01 0.71   -0.96   -0.04    0.45    0.94    1.82  4020
    ## a[2,3]      0.18    0.01 0.88   -1.58   -0.39    0.18    0.78    1.87  4730
    ## a[3,1]      0.12    0.01 0.98   -1.77   -0.56    0.12    0.80    2.04  6071
    ## a[3,2]      0.20    0.01 0.92   -1.59   -0.44    0.21    0.84    2.00  4121
    ## a[3,3]      0.10    0.01 0.61   -1.08   -0.31    0.11    0.52    1.28  3265
    ## sigma      12.64    0.01 0.62   11.43   12.23   12.64   13.05   13.85  3970
    ## lp__     -213.14    0.06 2.52 -219.15 -214.58 -212.80 -211.35 -209.10  1724
    ##          Rhat
    ## alpha[1]    1
    ## alpha[2]    1
    ## alpha[3]    1
    ## a[1,1]      1
    ## a[1,2]      1
    ## a[1,3]      1
    ## a[2,1]      1
    ## a[2,2]      1
    ## a[2,3]      1
    ## a[3,1]      1
    ## a[3,2]      1
    ## a[3,3]      1
    ## sigma       1
    ## lp__        1
    ## 
    ## Samples were drawn using NUTS(diag_e) at Sun Nov 30 16:47:23 2025.
    ## For each parameter, n_eff is a crude measure of effective sample size,
    ## and Rhat is the potential scale reduction factor on split chains (at 
    ## convergence, Rhat=1).

    ## $summary
    ##                  mean     se_mean        sd         2.5%           25%
    ## alpha[1]    2.4483408 0.013153450 1.0266371    0.4458786    1.73839645
    ## alpha[2]    4.8834310 0.013283508 1.0141075    2.8540234    4.21831753
    ## alpha[3]    7.2928019 0.015137391 0.9961872    5.2987733    6.64298210
    ## a[1,1]      0.1736076 0.012545548 0.9675477   -1.7225297   -0.48299046
    ## a[1,2]      0.2823072 0.013352582 0.8985940   -1.5227013   -0.32912413
    ## a[1,3]      0.1043570 0.013041512 0.9413084   -1.7603812   -0.52596207
    ## a[2,1]      0.2701974 0.013905890 0.9103079   -1.5068229   -0.34785780
    ## a[2,2]      0.4511900 0.011243930 0.7129293   -0.9580678   -0.03985624
    ## a[2,3]      0.1810974 0.012789247 0.8796164   -1.5810479   -0.39469157
    ## a[3,1]      0.1240388 0.012533345 0.9765202   -1.7657437   -0.55973723
    ## a[3,2]      0.1986417 0.014296744 0.9177252   -1.5905442   -0.43633660
    ## a[3,3]      0.1034587 0.010640795 0.6080615   -1.0828875   -0.30682568
    ## sigma      12.6425915 0.009812477 0.6182675   11.4282094   12.22799175
    ## lp__     -213.1449182 0.060652445 2.5186257 -219.1521943 -214.58356722
    ##                   50%          75%       97.5%    n_eff      Rhat
    ## alpha[1]    2.4640267    3.1545801    4.476232 6091.925 0.9997590
    ## alpha[2]    4.8753467    5.5348821    6.887055 5828.307 1.0002313
    ## alpha[3]    7.2746359    7.9652926    9.255718 4330.917 0.9994348
    ## a[1,1]      0.1541832    0.8291595    2.053603 5947.925 0.9994842
    ## a[1,2]      0.2839978    0.8679795    2.059309 4528.939 1.0001407
    ## a[1,3]      0.1099882    0.7274960    1.913566 5209.643 0.9998390
    ## a[2,1]      0.2803412    0.8932988    2.002798 4285.278 0.9996353
    ## a[2,2]      0.4479287    0.9386575    1.819620 4020.283 1.0004821
    ## a[2,3]      0.1799180    0.7752186    1.873596 4730.387 1.0000489
    ## a[3,1]      0.1192621    0.7953347    2.041324 6070.556 0.9993672
    ## a[3,2]      0.2052451    0.8427966    2.002679 4120.511 0.9998070
    ## a[3,3]      0.1115246    0.5238074    1.277836 3265.479 0.9999733
    ## sigma      12.6363355   13.0539078   13.849135 3970.046 0.9995814
    ## lp__     -212.8039913 -211.3535258 -209.095971 1724.371 1.0011129
    ## 
    ## $c_summary
    ## , , chains = chain:1
    ## 
    ##           stats
    ## parameter           mean        sd         2.5%           25%           50%
    ##   alpha[1]    2.45934583 1.0135674    0.4179135    1.74957063    2.50663262
    ##   alpha[2]    4.86567130 1.0340323    2.7847594    4.16445705    4.84113622
    ##   alpha[3]    7.26756884 0.9924162    5.2494018    6.62372636    7.25631829
    ##   a[1,1]      0.20085279 0.9878884   -1.8011856   -0.40639555    0.17226357
    ##   a[1,2]      0.29640969 0.8703151   -1.5014780   -0.30781329    0.31565295
    ##   a[1,3]      0.07318899 0.9554965   -1.8552624   -0.57631056    0.08776846
    ##   a[2,1]      0.26888900 0.9465486   -1.4067751   -0.44054478    0.30308121
    ##   a[2,2]      0.44927529 0.7169241   -1.0030710   -0.03137991    0.45048915
    ##   a[2,3]      0.14731508 0.8583282   -1.4933310   -0.42029951    0.12900199
    ##   a[3,1]      0.10547541 0.9522354   -1.8146880   -0.53151744    0.11715407
    ##   a[3,2]      0.21300655 0.9508577   -1.6430332   -0.44598192    0.24715410
    ##   a[3,3]      0.12831562 0.6389333   -1.1397851   -0.30507918    0.12947636
    ##   sigma      12.65956478 0.6308450   11.3992793   12.24994372   12.62756293
    ##   lp__     -213.20570117 2.5769194 -219.2362604 -214.78790885 -212.77136312
    ##           stats
    ## parameter           75%       97.5%
    ##   alpha[1]    3.1285247    4.584918
    ##   alpha[2]    5.5374317    6.890642
    ##   alpha[3]    8.0004676    9.025235
    ##   a[1,1]      0.8087950    2.207782
    ##   a[1,2]      0.8696364    1.953955
    ##   a[1,3]      0.7026415    1.913666
    ##   a[2,1]      0.9692130    1.952296
    ##   a[2,2]      0.9583874    1.783188
    ##   a[2,3]      0.7211969    1.866159
    ##   a[3,1]      0.7482244    1.971011
    ##   a[3,2]      0.8661907    2.049909
    ##   a[3,3]      0.5690055    1.427901
    ##   sigma      13.0857130   13.855436
    ##   lp__     -211.3921844 -209.061169
    ## 
    ## , , chains = chain:2
    ## 
    ##           stats
    ## parameter          mean        sd         2.5%          25%          50%
    ##   alpha[1]    2.4565688 1.0538523    0.4064594    1.7482048    2.4429771
    ##   alpha[2]    4.9454681 1.0422569    2.8134000    4.2590552    4.9503317
    ##   alpha[3]    7.2991754 1.0064969    5.4388779    6.7026014    7.2232110
    ##   a[1,1]      0.1591829 0.9716218   -1.7502081   -0.5000531    0.1345864
    ##   a[1,2]      0.2788525 0.9128240   -1.4919621   -0.3568282    0.2858753
    ##   a[1,3]      0.1040846 0.9197180   -1.6772294   -0.5531105    0.1000842
    ##   a[2,1]      0.2318608 0.8771247   -1.5730616   -0.3712627    0.2205301
    ##   a[2,2]      0.4901574 0.7016901   -0.8874645    0.0276922    0.4928821
    ##   a[2,3]      0.1645650 0.8819054   -1.6095166   -0.4094332    0.1546149
    ##   a[3,1]      0.1293829 1.0225706   -1.8297680   -0.5545834    0.1091704
    ##   a[3,2]      0.1790648 0.9280234   -1.6704796   -0.4491806    0.1978762
    ##   a[3,3]      0.1180997 0.6166276   -1.0536608   -0.2907399    0.1417150
    ##   sigma      12.6288386 0.6101340   11.4829968   12.2049302   12.6125036
    ##   lp__     -213.1976761 2.5525265 -219.2158771 -214.5455781 -212.8218335
    ##           stats
    ## parameter           75%       97.5%
    ##   alpha[1]    3.1579444    4.543737
    ##   alpha[2]    5.6444223    6.894557
    ##   alpha[3]    7.9429386    9.372444
    ##   a[1,1]      0.8556960    2.016450
    ##   a[1,2]      0.8742331    2.159123
    ##   a[1,3]      0.7059391    1.925835
    ##   a[2,1]      0.8604660    1.893010
    ##   a[2,2]      0.9465423    1.926744
    ##   a[2,3]      0.7510022    1.858585
    ##   a[3,1]      0.8066934    2.081919
    ##   a[3,2]      0.8178268    2.008978
    ##   a[3,3]      0.5539497    1.316357
    ##   sigma      13.0457791   13.837159
    ##   lp__     -211.3684790 -209.223439
    ## 
    ## , , chains = chain:3
    ## 
    ##           stats
    ## parameter           mean        sd         2.5%           25%          50%
    ##   alpha[1]    2.46195807 1.0031734    0.4932576    1.79482617    2.4660319
    ##   alpha[2]    4.86604210 0.9593319    2.9553456    4.27377684    4.8768109
    ##   alpha[3]    7.30227807 1.0139771    5.3193147    6.62189363    7.2840966
    ##   a[1,1]      0.17780670 1.0040639   -1.7582899   -0.51272130    0.1768200
    ##   a[1,2]      0.26776163 0.8856127   -1.4704973   -0.32767016    0.2731084
    ##   a[1,3]      0.12787803 0.8889331   -1.5355963   -0.49224819    0.1259117
    ##   a[2,1]      0.26682114 0.9040586   -1.5021181   -0.33079826    0.2518956
    ##   a[2,2]      0.45293725 0.6942463   -0.8480170   -0.03500339    0.4409400
    ##   a[2,3]      0.19733674 0.9087298   -1.6164358   -0.38940641    0.1912393
    ##   a[3,1]      0.13054395 0.9471893   -1.6262748   -0.57441385    0.1470309
    ##   a[3,2]      0.18769709 0.8882627   -1.4995235   -0.42124244    0.1484467
    ##   a[3,3]      0.09318144 0.5832926   -1.0873711   -0.29524957    0.1021751
    ##   sigma      12.65632907 0.6169053   11.4426780   12.25054093   12.6663822
    ##   lp__     -213.04678664 2.4660940 -219.0997983 -214.39340103 -212.7891173
    ##           stats
    ## parameter           75%       97.5%
    ##   alpha[1]    3.1751371    4.380645
    ##   alpha[2]    5.4639172    6.782426
    ##   alpha[3]    7.9609200    9.316650
    ##   a[1,1]      0.8629187    2.054058
    ##   a[1,2]      0.8545704    2.035363
    ##   a[1,3]      0.7444940    1.811095
    ##   a[2,1]      0.8643349    2.078677
    ##   a[2,2]      0.9155718    1.796505
    ##   a[2,3]      0.8571489    1.867208
    ##   a[3,1]      0.7961225    1.987556
    ##   a[3,2]      0.8228011    1.882760
    ##   a[3,3]      0.5085050    1.179277
    ##   sigma      13.0419325   13.931609
    ##   lp__     -211.2764619 -209.121610
    ## 
    ## , , chains = chain:4
    ## 
    ##           stats
    ## parameter           mean        sd         2.5%          25%           50%
    ##   alpha[1]    2.41549051 1.0360334    0.4579268    1.6834010    2.42653953
    ##   alpha[2]    4.85654234 1.0176982    2.8474144    4.1528602    4.83246453
    ##   alpha[3]    7.30218535 0.9724220    5.2906642    6.6524231    7.33776074
    ##   a[1,1]      0.15658787 0.9044499   -1.5967823   -0.4852293    0.14705832
    ##   a[1,2]      0.28620487 0.9256703   -1.5658211   -0.3332692    0.26555110
    ##   a[1,3]      0.11227624 0.9981286   -1.8703965   -0.5384194    0.12641100
    ##   a[2,1]      0.31321882 0.9116848   -1.5562404   -0.2618228    0.32718561
    ##   a[2,2]      0.41239011 0.7370470   -0.9935366   -0.1236326    0.40061387
    ##   a[2,3]      0.21517255 0.8683935   -1.4618961   -0.3689284    0.22618410
    ##   a[3,1]      0.13075301 0.9834627   -1.7596907   -0.5765236    0.11324942
    ##   a[3,2]      0.21479853 0.9033646   -1.5279168   -0.4192211    0.20641644
    ##   a[3,3]      0.07423795 0.5912499   -1.0214122   -0.3460174    0.08892257
    ##   sigma      12.62563372 0.6151514   11.3781558   12.2094991   12.63893971
    ##   lp__     -213.12950909 2.4777136 -218.8631685 -214.5261344 -212.80965589
    ##           stats
    ## parameter           75%       97.5%
    ##   alpha[1]    3.1695604    4.360959
    ##   alpha[2]    5.5088930    6.900053
    ##   alpha[3]    7.9724845    9.194743
    ##   a[1,1]      0.7865776    1.904333
    ##   a[1,2]      0.8826646    2.179861
    ##   a[1,3]      0.7738570    2.021184
    ##   a[2,1]      0.9490708    2.096008
    ##   a[2,2]      0.9233273    1.817750
    ##   a[2,3]      0.7876276    1.955756
    ##   a[3,1]      0.8368375    2.065289
    ##   a[3,2]      0.8894765    1.915948
    ##   a[3,3]      0.5057164    1.146425
    ##   sigma      13.0391226   13.744310
    ##   lp__     -211.3674935 -209.129565
